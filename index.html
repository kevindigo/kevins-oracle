<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="teal">
    <meta name="description" content="Inspiration for solo RPG play - dice rolling, yes/no oracles, and creative generators">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Kevin's Oracle">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="icons/icon-192x192.svg">
    <link rel="apple-touch-icon" href="icons/icon-192x192.svg">
    <title>Kevin's Oracle</title>
    <script src="generators.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --button-color: teal;
            --button-hover: darkcyan;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(40, 40, 40, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.8;
        }

        .main-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .section-card {
            background: rgba(50, 50, 50, 0.8);
            border-radius: 10px;
            padding: 20px;
        }



        .theme-selector-section {
            margin: 20px 0;
            text-align: center;
        }

        .theme-selector {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(50, 50, 50, 0.8);
            border-radius: 25px;
            padding: 10px 20px;
            backdrop-filter: blur(10px);
        }

        .theme-selector label {
            font-weight: bold;
            font-size: 1em;
            opacity: 0.9;
        }

        .theme-selector select {
            /* Use the same colors as buttons */
            background: var(--button-color);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            padding-right: 32px;
            /* Let the browser handle the dropdown appearance */
            -webkit-appearance: menulist;
            -moz-appearance: menulist;
            appearance: menulist;
        }

        .theme-selector select:hover {
            background: var(--button-hover);
            transform: translateY(-1px);
        }

        .theme-selector select:focus {
            outline: none;
            background: var(--button-hover);
        }

        .theme-selector select:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .theme-selector select:focus {
            outline: none;
            transform: translateY(0);
        }

        .shared-result-section {
            position: sticky;
            top: 20px;
            z-index: 100;
            margin: 20px 0;
        }

        .shared-result {
            height: 120px;
            background: rgba(60, 60, 60, 0.8);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            backdrop-filter: blur(10px);
        }

        .result-header {
            font-size: 1em;
            font-weight: bold;
            text-align: left;
            opacity: 0.9;
        }

        .result-content {
            font-size: 1.5em;
            font-weight: bold;
            text-align: right;
            line-height: 1.3;
        }

        .dice-rolls {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 5px;
        }

        .text-muted {
            font-size: 0.8em;
            opacity: 0.8;
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .button-group button {
            padding: 6px 10px;
            font-size: 0.9em;
            min-width: auto;
            white-space: nowrap;
        }

        button {
            background: var(--button-color);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            background: var(--button-hover);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        /* Common button variations */
        .btn-small {
            padding: 4px 8px !important;
            font-size: 0.8em !important;
        }

        .feature-section {
            margin-top: 30px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .feature-card {
            background: rgba(50, 50, 50, 0.8);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            background: rgba(70, 70, 70, 0.8);
            transform: translateY(-2px);
        }

        .feature-card h3 {
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .feature-card p {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .mt-8 {
            margin-top: 8px;
        }

        footer {
            text-align: center;
            margin-top: 30px;
            opacity: 0.7;
            font-size: 0.9em;
        }

        .text-small {
            font-size: 0.8em;
        }

        .opacity-6 {
            opacity: 0.6;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .button-group {
                flex-direction: column;
            }

            .main-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŽ² Kevin's Oracle</h1>
            <p class="subtitle">Inspiration for solo RPG play</p>
        </header>

        <section class="theme-selector-section">
            <div class="theme-selector">
                <label for="theme-select">Theme:</label>
                <select id="theme-select">
                    <option value="fantasy">Fantasy</option>
                    <option value="space">Space</option>
                </select>
            </div>
        </section>

        <section class="shared-result-section">
            <div class="shared-result" id="sharedResult">
                <div class="result-header">Ready for adventure</div>
                <div class="result-content">Ask a question or roll some dice...</div>
            </div>
        </section>

        <div class="main-section">
            <section class="section-card">
                <h2>Yes/No Oracle</h2>
                <div class="button-group">
                    <button onclick="askYesNoUnlikely()">Unlikely</button>
                    <button onclick="askYesNoEven()">Even</button>
                    <button onclick="askYesNoLikely()">Likely</button>
                </div>
            </section>

            <section class="section-card">
                <h2>Dice Roller</h2>
                <div class="button-group">
                    <button onclick="rollD4()">d4</button>
                    <button onclick="roll1d6()">1d6</button>
                    <button onclick="roll2d6()">2d6</button>
                    <button onclick="roll3d6()">3d6</button>
                    <button onclick="rollD8()">d8</button>
                    <button onclick="rollD10()">d10</button>
                    <button onclick="rollD12()">d12</button>
                    <button onclick="rollD20()">d20</button>
                    <button onclick="rollD100()">d100</button>
                </div>
            </section>
        </div>

        <section class="feature-section">
            <h2>Additional Oracles</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>Start Scene</h3>
                    <div class="button-group mt-8">
                        <button onclick="alterScene()" class="btn-small">Alteration</button>
                    </div>
                </div>
                <div class="feature-card">
                    <h3>Inspiration Seeds</h3>
                    <div class="button-group mt-8">
                        <button onclick="generateAction()" class="btn-small">Action & Theme</button>
                    </div>
                </div>
                <div class="feature-card">
                    <h3>Plot Hook</h3>
                    <div class="button-group mt-8">
                        <button onclick="generatePlotHook()" class="btn-small">Generate</button>
                    </div>
                </div>
                <div class="feature-card">
                    <h3>Location</h3>
                    <div class="button-group mt-8">
                        <button onclick="generateLocation()" class="btn-small">Generate</button>
                    </div>
                </div>
                <div class="feature-card">
                    <h3>NPC</h3>
                    <div class="button-group mt-8">
                        <button onclick="generateNPC()" class="btn-small">Generate</button>
                    </div>
                </div>
                <div class="feature-card">
                    <h3>Random Event</h3>
                    <div class="button-group mt-8">
                        <button onclick="generateEvent()" class="btn-small">Generate</button>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <p>Â© 2025 Kevin B. Smith</p>
            <p>Dual licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" style="color: mediumturquoise">CC BY 4.0</a> or <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: mediumturquoise">MIT License</a></p>
            <p class="text-small opacity-6">This page was created with AI assistance</p>
        </footer>
    </div>

    <script>
        // Helper function to show result with flash effect
        function showResultWithFlash(header, content) {
            const resultDiv = document.getElementById('sharedResult');
            
            // Clear the content (flash effect)
            resultDiv.innerHTML = 
                `<div class="result-header">${header}</div>
                 <div class="result-content">&nbsp;</div>`;
            
            // Wait 100ms (1/10 second) then show the actual result
            setTimeout(() => {
                resultDiv.innerHTML = 
                    `<div class="result-header">${header}</div>
                     <div class="result-content">${content}</div>`;
            }, 100);
        }



        // Helper function to get twist text
        function getTwistText() {
            const twistRoll = Math.floor(Math.random() * 10) + 1;
            if (twistRoll === 1) {
                const action = getRandomAction();
                const theme = getRandomTheme();
                return `<div class="text-muted" style="margin-top: 8px;">Twist: ${action} ${theme}</div>`;
            }
            return '<br>&nbsp;';
        }

        // Shared Yes/No Oracle Response Generator
        function generateYesNoResponse(probabilityType) {
            // Define probability configurations
            const probabilityConfigs = {
                'likely': { yesCount: 14, noCount: 6 },
                'unlikely': { yesCount: 6, noCount: 14 },
                'even': { yesCount: 10, noCount: 10 }
            };
            
            // Get configuration for the requested probability type
            const config = probabilityConfigs[probabilityType] || probabilityConfigs.even;
            
            // Build the results array dynamically
            const results = [
                // Special yes responses (always included)
                'Strong yes', 'Yes, and...', 'Yes, but...',
                // Regular yes responses
                ...Array(config.yesCount - 3).fill('Yes'),
                // Special no responses (always included)
                'Strong no', 'No, and...', 'No, but...',
                // Regular no responses
                ...Array(config.noCount - 3).fill('No')
            ];
            
            const result = results[Math.floor(Math.random() * results.length)];
            const twistText = getTwistText();
            
            return { result, twistText };
        }

        // Yes/No Oracle
        function askYesNoEven() {
            const { result, twistText } = generateYesNoResponse('even');
            showResultWithFlash('Yes/No Oracle (even)', `${result}${twistText}`);
        }

        function askYesNoLikely() {
            const { result, twistText } = generateYesNoResponse('likely');
            showResultWithFlash('Yes/No Oracle (likely)', `${result}${twistText}`);
        }

        function askYesNoUnlikely() {
            const { result, twistText } = generateYesNoResponse('unlikely');
            showResultWithFlash('Yes/No Oracle (unlikely)', `${result}${twistText}`);
        }

        // Action & Theme Generator
        function generateAction() {
            const action = getRandomAction();
            const theme = getRandomTheme();
            
            showResultWithFlash('Action & Theme', `${action} ${theme}<br>&nbsp;`);
        }

        // Plot Hook / Quest Generator
        function generatePlotHook() {
            const themeSelect = document.getElementById('theme-select');
            const selectedTheme = themeSelect.value;
            
            if (selectedTheme === 'space') {
                generateSpacePlotHook();
            } else {
                // Default to fantasy
                const quests = [
                    'Rescue a kidnapped heir',
                    'Retrieve an ancient artifact',
                    'Stop a ritual summoning',
                    'Investigate a mysterious disappearances',
                    'Protect a frontier settlement',
                    'Sabotage an enemy weapon',
                    'Decode a cryptic message',
                    'Survive a magical storm',
                    'Negotiate a peace treaty',
                    'Find a lost colony',
                    'Destroy a corrupted creature',
                    'Explore a forgotten temple',
                    'Defend a sacred city',
                    'Uncover a royal conspiracy',
                    'Escape a cursed prison',
                    'Awaken a sleeping god',
                    'Break a ancient curse',
                    'Steal a legendary relic',
                    'Deliver a vital message',
                    'Hunt a rogue beast',
                    'Recover a stolen crown',
                    'Defeat a demonic lord',
                    'Create a magical amulet',
                    'Summon a elemental spirit',
                    'Banish a shadow creature',
                    'Heal a poisoned king',
                    'Cure a magical plague',
                    'Build a defensive wall',
                    'Repair a broken seal',
                    'Learn a forbidden spell',
                    'Discover a hidden library',
                    'Guard a royal wedding',
                    'Follow a prophetic dream',
                    'Destroy a cursed idol',
                    'Protect a sacred grove',
                    'Investigate a haunted ruins',
                    'Rescue a captured villagers',
                    'Find a lost prophecy',
                    'Stop an undead invasion',
                    'Recover a dragon egg',
                    'Defend a mountain pass',
                    'Uncover a spy network',
                    'Escape a collapsing mine',
                    'Awaken a stone guardian',
                    'Break a magical barrier',
                    'Steal enemy plans',
                    'Deliver a secret weapon',
                    'Hunt a monstrous predator',
                    'Recover a sunken treasure',
                    'Defeat a rival champion',
                    'Create a peace offering',
                    'Summon a celestial being',
                    'Banish a dark presence',
                    'Heal a wounded dragon',
                    'Cure a mind control',
                    'Build a magical bridge',
                    'Repair a time portal',
                    'Learn an ancient language',
                    'Discover a secret passage',
                    'Guard a magical fountain',
                    'Follow a star map',
                    'Destroy an evil cult',
                    'Protect an oracle',
                    'Investigate strange lights',
                    'Rescue an enslaved tribe',
                    'Find a philosopher stone',
                    'Stop a blood ritual',
                    'Recover stolen knowledge',
                    'Defend a crystal cave',
                    'Uncover a hidden identity',
                    'Escape a labyrinth',
                    'Awaken a forest spirit',
                    'Break a mind control',
                    'Steal a magic crystal',
                    'Deliver peace terms',
                    'Hunt a ghostly apparition',
                    'Recover a family heirloom',
                    'Defeat a rival mage',
                    'Create a protective ward',
                    'Summon a weather spirit',
                    'Banish a plague demon',
                    'Heal a cursed land',
                    'Cure a magical corruption',
                    'Build a underground sanctuary',
                    'Repair a magical device',
                    'Learn a secret technique',
                    'Discover a hidden city',
                    'Guard a sacred ritual',
                    'Follow an ancient map',
                    'Destroy a cursed tree',
                    'Protect a magical creature',
                    'Investigate a time anomaly',
                    'Rescue trapped spirits',
                    'Find a legendary sword',
                    'Stop a planar breach',
                    'Recover a stolen throne',
                    'Defend a holy site',
                    'Uncover a lost history',
                    'Escape a dream realm',
                    'Awaken a mountain giant',
                    'Break a soul contract'
                ];
                
                const quest = quests[Math.floor(Math.random() * quests.length)];
                
                showResultWithFlash('Fantasy Plot Hook', quest);
            }
        }

        // Space Plot Hook Generator
        function generateSpacePlotHook() {
            const quests = [
                'Rescue a captured diplomat',
                'Retrieve a stolen data core',
                'Stop a pirate raid',
                'Investigate a derelict starship',
                'Protect a mining colony',
                'Sabotage an enemy battlecruiser',
                'Decode an alien transmission',
                'Survive a solar flare',
                'Negotiate a trade agreement',
                'Find a lost generation ship',
                'Destroy a rogue AI',
                'Explore an asteroid field',
                'Defend a space station',
                'Uncover a corporate conspiracy',
                'Escape a hostile sector',
                'Awaken a cryo-sleep crew',
                'Steal a prototype weapon',
                'Deliver medical supplies',
                'Hunt a space anomaly',
                'Recover a black box',
                'Defeat a rival mercenary group',
                'Create a jump gate',
                'Summon an alien fleet',
                'Banish a cosmic entity',
                'Heal a plague outbreak',
                'Cure a nanite infection',
                'Build an orbital defense',
                'Repair a warp drive',
                'Decode an alien language',
                'Discover a wormhole',
                'Guard a diplomatic summit',
                'Follow a distress signal',
                'Destroy a pirate base',
                'Protect a terraforming project',
                'Investigate a ghost ship',
                'Rescue a stranded colonists',
                'Find an ancient alien artifact',
                'Stop a superweapon activation',
                'Recover stolen experimental tech',
                'Defend a research outpost',
                'Find the origin of a spy satellite',
                'Escape a gravity well',
                'Awaken a dormant AI',
                'Break a security system',
                'Steal some star charts',
                'Deliver a peace envoy',
                'Explore a rogue asteroid',
                'Recover a stolen ship',
                'Defeat a rival corporation',
                'Create a planetary shield',
                'Summon a rescue fleet',
                'Banish an energy being',
                'Heal a radiation sickness',
                'Cure a memory wipe',
                'Build a space elevator',
                'Repair a life support system',
                'Learn a hacking protocol',
                'Discover a hidden base',
                'Guard a fuel depot',
                'Follow an energy signature',
                'Destroy a smuggling ring',
                'Protect an ambassador',
                'Investigate a time dilation',
                'Rescue a captured scientist',
                'Find a quantum computer',
                'Deliver medical supplies',
                'Transport a relic',
                'Stop a reactor meltdown',
                'Recover genetic samples',
                'Defend a jump point',
                'Uncover a false identity',
                'Escape a nebula storm',
                'Awaken a terraforming AI',
                'Break an encryption code',
                'Steal military plans',
                'Deliver emergency supplies',
                'Hunt a rogue drone swarm',
                'Recover an alien specimen',
                'Defeat a rival captain',
                'Create a diplomatic channel',
                'Summon a trading convoy',
                'Banish a parasitic organism',
                'Heal an ecosystem',
                'Cure a cybernetic virus',
                'Build a deep space relay',
                'Repair a sensor array',
                'Transport an alien technology',
                'Discover a hidden colony',
                'Guard a cargo shipment',
                'Follow a comet trail',
                'Destroy a listening post',
                'Protect a generation ship',
                'Investigate a signal source',
                'Rescue a captured crew',
                'Find a lost probe',
                'Stop an asteroid impact',
                'Recover stolen research',
                'Defend a comms satellite',
                'Uncover a hidden agenda',
                'Escape a black hole',
                'Explore an ancient starship',
                'Break an illegal blockade'
            ];
            
            const quest = quests[Math.floor(Math.random() * quests.length)];
            
            showResultWithFlash('Space Plot Hook', quest);
        }

        // Fantasy Location Generator (now uses imported function from generators.js)
        function generateFantasyLocation() {
            const { location, placeName } = window.generateFantasyLocation();
            showResultWithFlash('Fantasy Location', `${location}<br>at ${placeName}`);
        }

        // Location Generator
        function generateLocation() {
            const themeSelect = document.getElementById('theme-select');
            const selectedTheme = themeSelect.value;
            
            if (selectedTheme === 'space') {
                generateSpaceLocation();
            } else {
                // Default to fantasy
                generateFantasyLocation();
            }
        }

        // Space Location Generator (now uses imported function from generators.js)
        function generateSpaceLocation() {
            const { location, placeName } = window.generateSpaceLocation();
            showResultWithFlash('Space Location', `${location}<br>at ${placeName}`);
        }



        // Fantasy NPC Generator (now imported from generators.js)
        function generateFantasyNPC() {
            const { name, descriptor, personality, role } = window.generateFantasyNPC();
            showResultWithFlash('Fantasy NPC', `${name}<br><span class="text-muted">${descriptor} ${personality} ${role}</span>`);
        }



        // NPC Generator
        function generateNPC() {
            const themeSelect = document.getElementById('theme-select');
            const selectedTheme = themeSelect.value;
            
            if (selectedTheme === 'space') {
                generateSpaceNPC();
            } else {
                // Default to fantasy
                generateFantasyNPC();
            }
        }

        // Space NPC Generator
        function generateSpaceNPC() {
            const personalities = [
                'Calculating', 'Impulsive', 'Logical', 'Intuitive', 'Confident',
                'Anxious', 'Optimistic', 'Pessimistic', 'Friendly', 'Hostile',
                'Curious', 'Indifferent', 'Honest', 'Deceptive', 'Brave',
                'Cautious', 'Patient', 'Arrogant', 'Humble', 'Generous',
                'Greedy', 'Loyal', 'Treacherous', 'Witty', 'Serious',
                'Playful', 'Stoic', 'Emotional', 'Creative', 'Traditional',
                'Rebellious', 'Obedient', 'Suspicious', 'Trusting', 'Ambitious', 'Methodical'
            ];
            
            const descriptors = [
                'Tall', 'Short', 'Slender', 'Stocky', 'Muscular',
                'Lean', 'Broad-shouldered', 'Petite', 'Lanky', 'Stout',
                'Bald', 'Short-haired', 'Slick-haired', 'Bearded', 'Clean-shaven',
                'Scarred', 'Tattooed', 'Pale', 'Tanned', 'Freckled',
                'Aged', 'Youthful', 'Middle-aged', 'Elderly', 'Vibrant',
                'Weathered', 'Graceful', 'Clumsy', 'Agile', 'Imposing',
                'Unassuming', 'Striking', 'Plain', 'Elegant', 'Rugged', 'Enhanced'
            ];
            
            const roles = [
                'Captain', 'Pilot', 'Engineer', 'Scientist', 'Medic',
                'Soldier', 'Marine', 'Security', 'Diplomat', 'Ambassador',
                'Merchant', 'Trader', 'Smuggler', 'Bounty Hunter', 'Pirate',
                'Explorer', 'Scout', 'Surveyor', 'Colonist', 'Settler',
                'Technician', 'Mechanic', 'Programmer', 'Hacker', 'Cyberneticist',
                'Xenobiologist', 'Astrophysicist', 'Psychic', 'Telepath', 'Precog',
                'Android', 'Cyborg', 'Alien', 'Mutant', 'Augmented', 'Specialist'
            ];
            
            const name = window.generateSpaceName();
            const personality = personalities[Math.floor(Math.random() * personalities.length)];
            const descriptor = descriptors[Math.floor(Math.random() * descriptors.length)];
            const role = roles[Math.floor(Math.random() * roles.length)];
            
            showResultWithFlash('Space NPC', `${name}<br><span class="text-muted">${descriptor} ${personality} ${role}</span>`);
        }

        // Fantasy Random Event Generator
        function generateFantasyEvent() {
            // Encounters (36)
            const encounters = [
                'Bandits ambush the party', 'A friendly merchant offers goods',
                'A lost child needs help', 'A rival adventuring party crosses paths',
                'A wandering minstrel shares news', 'A group of pilgrims seeks protection',
                'A bounty hunter is tracking someone', 'A patrol questions the party',
                'A mysterious hermit offers wisdom', 'A group of refugees needs aid',
                'A traveling healer offers services', 'A noble and their entourage pass by',
                'A group of locals shares their findings', 'A messenger with urgent news',
                'A rival mage challenges to a duel', 'A group of smugglers at work',
                'A lost scholar seeks ancient knowledge', 'A group of bards performs nearby',
                'A wandering knight offers assistance', 'A suspicious merchant with rare goods',
                'A group of cultists performing a ritual', 'A lone ranger tracking prey',
                'A group of escaped prisoners', 'A traveling entertainment troupe sets up camp',
                'A mysterious fortune teller', 'A group of pilgrims on a holy quest',
                'A rival thief trying to steal', 'A group of mercenaries for hire',
                'A wandering monk shares teachings', 'A suspicious alchemist with potions',
                'A group of rebels planning something', 'A lone survivor of an attack',
                'A traveling diplomat needs escort', 'A group of workers with strange findings',
                'A mysterious shapeshifter appears', 'A group of locals with a strange discovery'
            ];
            
            // Hazards (36)
            const hazards = [
                'A sudden rockslide blocks the path', 'A magical storm causes confusion',
                'A sinkhole opens nearby', 'A flash flood washes through',
                'A forest fire spreads rapidly', 'A magical mist causes disorientation',
                'A sudden blizzard hits', 'An earthquake shakes the ground',
                'A swarm of insects attacks', 'A poisonous plant releases spores',
                'A cursed area drains energy', 'A magical vortex appears',
                'A sudden fog limits visibility', 'A thunderstorm with magical lightning',
                'A geyser erupts nearby', 'A magical field causes illusions',
                'A sudden temperature drop', 'A magical silence descends',
                'A river suddenly changes course', 'A magical darkness envelops the area',
                'A sudden sandstorm arises', 'A magical storm of feathers',
                'A sudden ice storm hits', 'A magical field reverses gravity',
                'A sudden mudslide occurs', 'A magical field causes time distortion',
                'A sudden volcanic activity', 'A magical field causes memory loss',
                'A sudden windstorm picks up', 'A magical field causes aging',
                'A sudden hailstorm begins', 'A magical field causes youth',
                'A sudden dust devil forms', 'A magical field causes laughter',
                'A sudden lightning strike', 'A magical field causes sleep'
            ];
            
            // Obstructions/Traps (36)
            const obstructions = [
                'A collapsed bridge blocks progress', 'A hidden pit trap is discovered',
                'A magical barrier blocks the way', 'A complex lock needs picking',
                'A riddle must be solved to proceed', 'A pressure plate triggers something',
                'A magical seal needs breaking', 'A hidden door is found',
                'A maze of corridors confuses', 'A magical puzzle must be solved',
                'A portcullis drops suddenly', 'A magical ward must be dispelled',
                'A false floor gives way', 'A magical mirror shows illusions',
                'A swinging blade trap activates', 'A magical glyph must be deciphered',
                'A rolling boulder blocks the path', 'A magical statue comes to life',
                'A poison dart trap is triggered', 'A magical rune must be activated',
                'A net trap captures someone', 'A magical door requires a password',
                'A spike pit is revealed', 'A magical barrier requires a sacrifice',
                'A falling ceiling trap', 'A magical lock requires a specific item',
                'A tripwire triggers an alarm', 'A magical field requires a spell',
                'A false treasure is a trap', 'A magical puzzle requires intuition',
                'A hidden compartment is found', 'A magical test must be passed',
                'A secret passage is blocked', 'A magical guardian must be defeated',
                'A complex mechanism needs fixing', 'A magical illusion hides the path'
            ];
            
            // Miscellaneous (36: 12 good, 12 neutral, 12 bad/scary)
            const goodEvents = [
                'A hidden cache of supplies is found', 'A friendly animal offers help',
                'A forgotten shrine provides blessing', 'A lucky find provides advantage',
                'A helpful NPC offers information', 'A magical item is discovered',
                'A hidden talent is revealed', 'A helpful spirit appears',
                'A magical blessing is received', 'A sudden ally appears',
                'A magical gift is given', 'A sudden breakthrough occurs'
            ];
            
            const neutralEvents = [
                'A strange omen appears in the sky', 'A mysterious note is discovered',
                'A sudden insight solves a problem', 'A sudden inspiration strikes',
                'A stroke of good luck occurs', 'A sudden change in weather helps',
                'A forgotten memory returns', 'A helpful coincidence occurs',
                'A sudden realization helps', 'A helpful dream provides guidance',
                'A helpful sign appears', 'A helpful discovery is made'
            ];
            
            const badEvents = [
                'A cursed item is discovered', 'A foreboding vision appears',
                'A mysterious illness strikes', 'A bad omen is seen',
                'A valuable item is lost', 'A trusted contact betrays',
                'A magical curse is placed', 'A haunting presence appears',
                'A terrible nightmare occurs', 'A dangerous secret is uncovered',
                'A frightening prophecy is heard', 'A shadowy figure follows'
            ];
            
            const miscellaneous = [...goodEvents, ...neutralEvents, ...badEvents];
            
            // Combine all categories
            const allEvents = [...encounters, ...hazards, ...obstructions, ...miscellaneous];
            const event = allEvents[Math.floor(Math.random() * allEvents.length)];
            showResultWithFlash('Fantasy Random Event', event);
        }

        // Random Event Generator
        function generateEvent() {
            const themeSelect = document.getElementById('theme-select');
            const selectedTheme = themeSelect.value;
            
            if (selectedTheme === 'space') {
                generateSpaceEvent();
            } else {
                // Default to fantasy
                generateFantasyEvent();
            }
        }

        // Space Random Event Generator
        function generateSpaceEvent() {
            // Encounters (36)
            const encounters = [
                'A pirate ship demands surrender', 'A friendly trader offers supplies',
                'A distress call from a civilian ship', 'A rival bounty hunter crosses paths',
                'A wandering merchant with rare tech', 'A group of refugees needs rescue',
                'A corporate security patrol questions', 'A lone explorer shares discoveries',
                'A mysterious alien offers help', 'A group of smugglers at work',
                'A medical ship offers assistance', 'A diplomatic envoy needs escort',
                'A group of workers with strange ore', 'A messenger drone with urgent data',
                'A rival corporation ship challenges', 'A group of scavengers picking debris',
                'A lost scientist seeks protection', 'A group of colonists celebrating',
                'A wandering mercenary offers services', 'A suspicious dealer with illegal tech',
                'A cult ship performing rituals', 'A lone scout tracking something',
                'A group of escaped prisoners', 'A traveling entertainment vessel',
                'A mysterious psychic appears', 'A group of pilgrims on spiritual quest',
                'A rival spy trying to infiltrate', 'A group of mercenaries for hire',
                'A wandering monk shares wisdom', 'A suspicious scientist with experiments',
                'A rebel cell planning operation', 'A lone survivor of attack',
                'A diplomatic ship needs help', 'A group of asteroid workers',
                'A shapeshifting alien appears', 'A group of researchers with discovery'
            ];
            
            // Hazards (36)
            const hazards = [
                'A solar flare threatens systems', 'A meteor swarm approaches',
                'A gravity well pulls ship off course', 'A radiation storm hits',
                'A nebula causes sensor interference', 'The gravity effect of a black hole affects a ship',
                'A sudden ion storm damages electronics', 'A plasma discharge from nearby star',
                'A rogue asteroid field appears', 'A quantum anomaly causes confusion',
                'A temporal distortion field', 'A spatial rift opens nearby',
                'A sudden EMP blast disables systems', 'A cosmic string affects navigation',
                'A dark matter cloud obscures sensors', 'A wormhole instability',
                'A sudden temperature fluctuation', 'A magnetic field disruption',
                'A subspace interference pattern', 'A reality distortion field',
                'A sudden pressure change', 'A chroniton radiation leak',
                'A quantum foam disturbance', 'A dimensional instability',
                'A sudden radiation spike', 'A psychic energy field',
                'A gravitational anomaly', 'A temporal loop begins',
                'A sudden energy drain', 'A phase variance occurs',
                'A subspace rift appears', 'A quantum entanglement event',
                'A sudden system overload', 'A reality bubble forms',
                'A cosmic background radiation spike', 'A quantum probability shift'
            ];
            
            // Obstructions/Traps (36)
            const obstructions = [
                'A debris field blocks navigation', 'A hidden minefield is detected',
                'An energy barrier blocks the way', 'A complex security system activates',
                'A computer puzzle must be solved', 'A proximity sensor triggers defense',
                'A quantum lock needs bypassing', 'A hidden compartment is found',
                'A maze of asteroid tunnels', 'A logic puzzle must be completed',
                'A security door slams shut', 'A force field must be deactivated',
                'A false floor gives way', 'A holographic illusion confuses',
                'A laser grid trap activates', 'A data encryption must be broken',
                'A collapsing tunnel blocks path', 'A security drone activates',
                'A gas trap is triggered', 'A biometric lock needs access',
                'A net launcher captures target', 'A voice recognition system',
                'A pressure plate reveals trap', 'A neural interface challenge',
                'A falling ceiling trap', 'A quantum encryption puzzle',
                'A motion sensor triggers alarm', 'A DNA lock requires sample',
                'A false data package is trap', 'A psychic barrier must be overcome',
                'A hidden data cache found', 'A technological test must be passed',
                'A secret passage is sealed', 'A robotic guardian must be defeated',
                'A complex circuit needs repair', 'A cloaking field hides the path'
            ];
            
            // Miscellaneous (36: 12 good, 12 neutral, 12 bad/scary)
            const goodEvents = [
                'A hidden supply cache is found', 'A friendly alien offers assistance',
                'A forgotten outpost provides resources', 'A lucky scan reveals valuable data',
                'A helpful AI offers information', 'An advanced technology is discovered',
                'A hidden skill is revealed', 'A helpful hologram appears',
                'A technological blessing received', 'A sudden ally ship appears',
                'A technological gift is given', 'A sudden system breakthrough'
            ];
            
            const neutralEvents = [
                'A strange cosmic phenomenon appears', 'A mysterious data packet discovered',
                'A sudden insight solves technical problem', 'A sudden breakthrough in research',
                'A stroke of cosmic luck occurs', 'A sudden solar flare helps escape',
                'A forgotten memory returns', 'A helpful coincidence in navigation',
                'A sudden realization helps mission', 'A helpful dream simulation',
                'A helpful signal appears', 'A helpful discovery in database'
            ];
            
            const badEvents = [
                'A corrupted data file is found', 'A terrifying vision appears on screen',
                'A mysterious system virus infects', 'A bad transmission is received',
                'A valuable component malfunctions', 'A trusted crew member acts strangely',
                'A system curse is detected', 'A ghostly presence appears on sensors',
                'A nightmare simulation occurs', 'A dangerous secret file is uncovered',
                'A frightening prophecy is decoded', 'A shadowy ship follows at distance'
            ];
            
            const miscellaneous = [...goodEvents, ...neutralEvents, ...badEvents];
            
            // Combine all categories
            const allEvents = [...encounters, ...hazards, ...obstructions, ...miscellaneous];
            const event = allEvents[Math.floor(Math.random() * allEvents.length)];
            showResultWithFlash('Space Random Event', event);
        }

        // Scene Alteration Oracle
        function alterScene() {
            // Scene alteration types
            const alterationTypes = ['Alter', 'Interrupt'];
            
            // Mythic GM Emulator scene alteration topics
            const topics = [
                'NPC action', 'NPC action', 'NPC action', 
                'NPC negative', 'NPC positive', 
                'PC negative', 'PC positive', 
                'Remote event', 'Ambiguous event',
                'Move toward a thread', 'Move away from or close a thread', 
                'Introduce a new NPC', 'Introduce a new thread'
            ];
            
            const alterationType = alterationTypes[Math.floor(Math.random() * alterationTypes.length)];
            const topic = topics[Math.floor(Math.random() * topics.length)];
            
            showResultWithFlash('Scene Alteration', `${alterationType}<br><span class="text-muted">${topic}</muted>`);
        }

        // Generic Dice Roller Function
        function rollDice(sides, count = 1) {
            let total = 0;
            let rolls = [];
            
            for (let i = 0; i < count; i++) {
                const roll = Math.floor(Math.random() * sides) + 1;
                rolls.push(roll);
                total += roll;
            }
            
            return { total, rolls };
        }

        // Individual dice functions become simple wrappers
        function rollD4() {
            const { total } = rollDice(4);
            showResultWithFlash('d4 Dice Roll', `${total}<br>&nbsp;`);
        }

        function roll1d6() {
            const { total } = rollDice(6);
            showResultWithFlash('1d6 Dice Roll', `${total}<br>&nbsp;`);
        }

        function roll2d6() {
            const { total, rolls } = rollDice(6, 2);
            showResultWithFlash('2d6 Dice Roll', `${total}<br><span class="text-muted">${rolls.join(' + ')}</span>`);
        }

        function roll3d6() {
            const { total, rolls } = rollDice(6, 3);
            showResultWithFlash('3d6 Dice Roll', `${total}<br><span class="text-muted">${rolls.join(' + ')}</span>`);
        }

        function rollD8() {
            const { total } = rollDice(8);
            showResultWithFlash('d8 Dice Roll', `${total}<br>&nbsp;`);
        }

        function rollD10() {
            const { total } = rollDice(10);
            showResultWithFlash('d10 Dice Roll', `${total}<br>&nbsp;`);
        }

        function rollD12() {
            const { total } = rollDice(12);
            showResultWithFlash('d12 Dice Roll', `${total}<br>&nbsp;`);
        }

        function rollD20() {
            const { total } = rollDice(20);
            showResultWithFlash('d20 Dice Roll', `${total}<br>&nbsp;`);
        }

        function rollD100() {
            const { total } = rollDice(100);
            showResultWithFlash('d100 Dice Roll', `${total}<br>&nbsp;`);
        }

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }

        // PWA Install Prompt Handling
        let deferredPrompt;
        const installButton = document.createElement('button');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            
            // Create and show install button
            installButton.textContent = 'ðŸ“± Install App';
            installButton.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: teal;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 25px;
                font-weight: bold;
                cursor: pointer;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                transition: all 0.3s ease;
            `;
            
            installButton.addEventListener('mouseenter', () => {
                installButton.style.background = 'darkcyan';
                installButton.style.transform = 'translateY(-2px)';
            });
            
            installButton.addEventListener('mouseleave', () => {
                installButton.style.background = 'teal';
                installButton.style.transform = 'translateY(0)';
            });
            
            document.body.appendChild(installButton);
            
            installButton.addEventListener('click', async () => {
                // Hide the install button
                installButton.style.display = 'none';
                // Show the install prompt
                deferredPrompt.prompt();
                // Wait for the user to respond to the prompt
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User response to the install prompt: ${outcome}`);
                // We've used the prompt, and can't use it again, throw it away
                deferredPrompt = null;
            });
        });

        window.addEventListener('appinstalled', () => {
            // Hide the install button after successful installation
            if (installButton.parentNode) {
                installButton.parentNode.removeChild(installButton);
            }
            console.log('PWA was installed');
        });

        // Check if app is already installed
        window.addEventListener('load', () => {
            if (window.matchMedia('(display-mode: standalone)').matches) {
                console.log('App is running in standalone mode');
                // App is already installed, don't show install button
                if (installButton.parentNode) {
                    installButton.parentNode.removeChild(installButton);
                }
            }
        });
    </script>
</body>
</html>